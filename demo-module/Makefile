compile:
	cargo b

# This target generates the WebAssembly Component Module using the wasm module
# with the custom section generated by the 'core-module.wasm' target.
component:
	wasm-tools component new target/wasm32-wasi/debug/demo_module.wasm \
	--adapt wasi_snapshot_preview1.wasm \
    	-o demo_component.wasm
	#
# Generates the Python bindings for the component.
bindings: 
	python3 ../wasmtime/bindgen demo_component.wasm --out-dir dist

run: 
	@python3 demo.py

all: compile component bindings run

wit-bindgen:
	wit-bindgen rust wit

.PHONY: clean
clean:
	${RM} -rf dist demo_component.wasm && cargo clean
